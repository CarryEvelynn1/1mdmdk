<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    [span_0](start_span)<title>Bot Ayarları - Guard Bot[span_0](end_span)</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
    <style>
        :root {
            /* Daha canlı ve modern bir renk paleti */
            --primary-color: #7289da;
            -[span_1](start_span)-secondary-color: #23272a;[span_1](end_span)
            --accent-color: #5865f2;
            --success-color: #2ecc71;
            --danger-color: #ff4757;
            --warning-color: #ffa502;
            --dark-bg: #0c0c0d;
            -[span_2](start_span)-card-bg: rgba(35, 39, 42, 0.95);[span_2](end_span)
            -[span_3](start_span)-text-primary: #ffffff;[span_3](end_span)
            -[span_4](start_span)-text-secondary: #a3a6aa;[span_4](end_span)
            -[span_5](start_span)-border-color: rgba(255, 255, 255, 0.05);[span_5](end_span)
        }
        body {
            /* Akıcı bir derinlik için geliştirilmiş gradient */
            [span_6](start_span)background: radial-gradient(circle at top right, #1e1e2f 0%, #0f0f1a 100%);[span_6](end_span)
            [span_7](start_span)color: var(--text-primary);[span_7](end_span)
            [span_8](start_span)font-family: 'Inter', 'Segoe UI', system-ui, -apple-system, sans-serif;[span_8](end_span)
            [span_9](start_span)min-height: 100vh;[span_9](end_span)
        }
        .sidebar {
            [span_10](start_span)position: fixed;[span_10](end_span)
            [span_11](start_span)left: 0;[span_11](end_span)
            [span_12](start_span)top: 0;[span_12](end_span)
            [span_13](start_span)height: 100vh;[span_13](end_span)
            [span_14](start_span)width: 280px;[span_14](end_span)
            [span_15](start_span)background: rgba(15, 15, 26, 0.8);[span_15](end_span)
            [span_16](start_span)backdrop-filter: blur(15px);[span_16](end_span)
            [span_17](start_span)border-right: 1px solid var(--border-color);[span_17](end_span)
            [span_18](start_span)z-index: 1000;[span_18](end_span)
            [span_19](start_span)transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);[span_19](end_span)
        }
        .sidebar-header {
            [span_20](start_span)padding: 30px 20px;[span_20](end_span)
            [span_21](start_span)border-bottom: 1px solid var(--border-color);[span_21](end_span)
            [span_22](start_span)text-align: center;[span_22](end_span)
        }
        .bot-avatar {
            [span_23](start_span)width: 70px;[span_23](end_span)
            [span_24](start_span)height: 70px;[span_24](end_span)
            [span_25](start_span)border-radius: 20px;[span_25](end_span)
            [span_26](start_span)border: 2px solid var(--primary-color);[span_26](end_span)
            [span_27](start_span)box-shadow: 0 0 20px rgba(114, 137, 218, 0.3);[span_27](end_span)
            [span_28](start_span)margin-bottom: 15px;[span_28](end_span)
        }
        .bot-name {
            [span_29](start_span)font-size: 1.1rem;[span_29](end_span)
            [span_30](start_span)font-weight: 800;[span_30](end_span)
            letter-spacing: 0.5px;
        }
        .nav-link {
            [span_31](start_span)display: flex;[span_31](end_span)
            [span_32](start_span)align-items: center;[span_32](end_span)
            [span_33](start_span)padding: 14px 25px;[span_33](end_span)
            [span_34](start_span)color: var(--text-secondary);[span_34](end_span)
            margin: 4px 15px;
            border-radius: 12px;
            [span_35](start_span)transition: 0.3s;[span_35](end_span)
        }
        .nav-link:hover, .nav-link.active {
            [span_36](start_span)background: rgba(114, 137, 218, 0.15);[span_36](end_span)
            [span_37](start_span)color: var(--primary-color);[span_37](end_span)
        }
        .main-content {
            [span_38](start_span)margin-left: 280px;[span_38](end_span)
            [span_39](start_span)padding: 40px;[span_39](end_span)
        }
        .header {
            [span_40](start_span)background: var(--card-bg);[span_40](end_span)
            [span_41](start_span)padding: 25px;[span_41](end_span)
            [span_42](start_span)border-radius: 24px;[span_42](end_span)
            [span_43](start_span)border: 1px solid var(--border-color);[span_43](end_span)
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
        }
        .page-title {
            [span_44](start_span)font-weight: 850;[span_44](end_span)
            [span_45](start_span)background: linear-gradient(to right, #fff, #7289da);[span_45](end_span)
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }
        .bot-settings-card {
            [span_46](start_span)background: var(--card-bg);[span_46](end_span)
            [span_47](start_span)border-radius: 30px;[span_47](end_span)
            [span_48](start_span)padding: 45px;[span_48](end_span)
            border: 1px solid var(--border-color);
            margin-top: 30px;
        }
        .status-box {
            [span_49](start_span)background: rgba(0, 0, 0, 0.2);[span_49](end_span)
            [span_50](start_span)border-radius: 20px;[span_50](end_span)
            [span_51](start_span)padding: 20px;[span_51](end_span)
            [span_52](start_span)border: 1px solid rgba(255, 255, 255, 0.03);[span_52](end_span)
        }
        .status-value {
            [span_53](start_span)color: var(--primary-color);[span_53](end_span)
            [span_54](start_span)font-size: 1.6rem;[span_54](end_span)
        }
        .form-control {
            [span_55](start_span)background: rgba(0, 0, 0, 0.2) !important;[span_55](end_span)
            [span_56](start_span)border: 1px solid var(--border-color) !important;[span_56](end_span)
            border-radius: 12px !important;
            [span_57](start_span)padding: 12px 18px;[span_57](end_span)
            [span_58](start_span)color: white !important;[span_58](end_span)
        }
        .form-control:focus {
            [span_59](start_span)border-color: var(--primary-color) !important;[span_59](end_span)
            [span_60](start_span)box-shadow: 0 0 15px rgba(114, 137, 218, 0.1) !important;[span_60](end_span)
        }
        .btn-primary { background: var(--primary-color); border: none; font-weight: 600; transition: 0.3s; }
        .btn-primary:hover { background: var(--accent-color); transform: translateY(-2px); }
        .logout-btn {
            [span_61](start_span)background: rgba(240, 71, 71, 0.1);[span_61](end_span)
            [span_62](start_span)color: var(--danger-color);[span_62](end_span)
            [span_63](start_span)padding: 10px 20px;[span_63](end_span)
            [span_64](start_span)border-radius: 12px;[span_64](end_span)
            border: 1px solid rgba(240, 71, 71, 0.2);
            [span_65](start_span)font-weight: 600;[span_65](end_span)
            [span_66](start_span)transition: 0.3s;[span_66](end_span)
        }
        .logout-btn:hover {
            [span_67](start_span)background: var(--danger-color);[span_67](end_span)
            [span_68](start_span)color: white;[span_68](end_span)
            [span_69](start_span)transform: translateY(-2px);[span_69](end_span)
        }
        .sidebar-toggle {
            display: none;
            position: fixed;
            top: 20px;
            right: 20px;
            z-index: 1001;
            background: var(--primary-color);
            border: none;
            color: white;
            padding: 10px 15px;
            border-radius: 10px;
        }
        @media (max-width: 992px) {
            .sidebar { transform: translateX(-100%); [span_70](start_span)}
            .sidebar.open { transform: translateX(0); }[span_70](end_span)
            .main-content { margin-left: 0; padding: 20px; [span_71](start_span)}
            .sidebar-toggle { display: block; }
        }
    </style>
</head>
<body>
    <button class="sidebar-toggle" onclick="toggleSidebar()">
        <i class="fas fa-bars"></i>
    </button>

    <div class="sidebar" id="sidebar">
        <div class="sidebar-header">
            <img src="<%= botAvatar %>" alt="Bot Avatar" class="bot-avatar">
            <div class="bot-name"><%= botUsername %></div>[span_71](end_span)
            <div class="bot-status">
                <span id="guardStatus" class="badge <%= guardEnabled ? 'bg-success' : 'bg-danger' %>">
                    <%= guardEnabled ? [span_72](start_span)'Aktif' : 'Pasif' %>[span_72](end_span)
                </span>
            </div>
        </div>
        <ul class="nav-menu">
            [span_73](start_span)<li class="nav-item"><a href="/dashboard/<%= guildID %>" class="nav-link"><i class="fas fa-tachometer-alt nav-icon"></i> Dashboard</a></li>[span_73](end_span)
            [span_74](start_span)<li class="nav-item"><a href="/guard/<%= guildID %>" class="nav-link"><i class="fas fa-shield-halved nav-icon"></i> Guard Ayarları</a></li>[span_74](end_span)
            [span_75](start_span)<li class="nav-item"><a href="/logs/<%= guildID %>" class="nav-link"><i class="fas fa-list-alt nav-icon"></i> Log Kayıtları</a></li>[span_75](end_span)
            [span_76](start_span)<li class="nav-item"><a href="/safe-users/<%= guildID %>" class="nav-link"><i class="fas fa-user-shield nav-icon"></i> Güvenli Kullanıcılar</a></li>[span_76](end_span)
            [span_77](start_span)<li class="nav-item"><a href="/roles/<%= guildID %>" class="nav-link"><i class="fas fa-user-tag nav-icon"></i> Rol Yönetimi</a></li>[span_77](end_span)
            [span_78](start_span)<li class="nav-item"><a href="/channels/<%= guildID %>" class="nav-link"><i class="fas fa-hashtag nav-icon"></i> Kanal Yönetimi</a></li>[span_78](end_span)
            [span_79](start_span)<li class="nav-item"><a href="/bot-settings/<%= guildID %>" class="nav-link active"><i class="fas fa-robot nav-icon"></i> Bot Ayarları</a></li>[span_79](end_span)
            [span_80](start_span)<li class="nav-item"><a href="/settings/<%= guildID %>" class="nav-link"><i class="fas fa-cog nav-icon"></i> Genel Ayarlar</a></li>[span_80](end_span)
        </ul>
    </div>

    <div class="main-content">
        <div class="header">
            <div class="header-left">
                [span_81](start_span)<h1 class="page-title">Bot Ayarları</h1>[span_81](end_span)
                <div class="server-info">
                    [span_82](start_span)<img src="<%= guild && guild.iconURL ? guild.iconURL({ size: 128, extension: 'png' }) : 'https://cdn.discordapp.com/embed/avatars/0.png' %>" alt="Server Icon" class="server-icon" onerror="this.src='https://cdn.discordapp.com/embed/avatars/0.png'">[span_82](end_span)
                    <div class="server-details">
                        [span_83](start_span)<h4><%= guild && guild.name ? guild.name : '' %></h4>[span_83](end_span)
                        [span_84](start_span)<p><%= guild && guild.memberCount ? guild.memberCount : '' %> üye</p>[span_84](end_span)
                    </div>
                </div>
            </div>
            <div class="user-actions">
                <a href="/logout" class="logout-btn">
                    [span_85](start_span)<i class="fas fa-sign-out-alt"></i> Çıkış Yap[span_85](end_span)
                </a>
            </div>
        </div>

        <div class="bot-settings-card">
            <div class="text-center mb-4">
                [span_86](start_span)<img src="<%= botAvatar %>" alt="Bot Avatar" class="bot-avatar-large">[span_86](end_span)
                [span_87](start_span)<div class="bot-name-large"><%= botUsername %></div>[span_87](end_span)
                [span_88](start_span)<div class="bot-id-large opacity-50">ID: <%= botId %></div>[span_88](end_span)
            </div>

            <div class="row g-4 mb-4">
                <div class="col-md-6">
                    <div class="status-box text-center">
                        [span_89](start_span)<div class="status-label text-uppercase small fw-bold opacity-50 mb-2">Gecikme</div>[span_89](end_span)
                        [span_90](start_span)<div class="status-value fw-bold"><%= ping %> ms</div>[span_90](end_span)
                    </div>
                </div>
                <div class="col-md-6">
                    <div class="status-box text-center">
                        [span_91](start_span)<div class="status-label text-uppercase small fw-bold opacity-50 mb-2">Uptime</div>[span_91](end_span)
                        [span_92](start_span)<div class="status-value fw-bold" id="uptime-value"></div>[span_92](end_span)
                    </div>
                </div>
            </div>

            <div class="d-flex flex-wrap justify-content-center gap-3 mb-5">
                [span_93](start_span)<button class="btn btn-success px-4" onclick="botControl('start')"><i class="fa fa-play me-2"></i> Başlat</button>[span_93](end_span)
                [span_94](start_span)<button class="btn btn-warning px-4 text-white" onclick="botControl('restart')"><i class="fa fa-rotate me-2"></i> Yeniden Başlat</button>[span_94](end_span)
                [span_95](start_span)<button class="btn btn-danger px-4" onclick="botControl('stop')"><i class="fa fa-stop me-2"></i> Durdur</button>[span_95](end_span)
            </div>

            [span_96](start_span)<div id="bot-action-result" class="text-center mb-4 fw-bold text-primary"></div>[span_96](end_span)

            [span_97](start_span)<div class="divider mb-5" style="height: 1px; background: var(--border-color)"></div>[span_97](end_span)

            <form id="username-form" class="mb-4">
                [span_98](start_span)<label class="form-label mb-3">Bot İsmi</label>[span_98](end_span)
                <div class="input-group">
                    [span_99](start_span)<input type="text" class="form-control" name="username" placeholder="Yeni bot ismi" maxlength="32" required>[span_99](end_span)
                    [span_100](start_span)<button class="btn btn-primary px-4" type="submit">Güncelle</button>[span_100](end_span)
                </div>
            </form>

            <form id="avatar-form">
                [span_101](start_span)<label class="form-label mb-3">Bot Avatarı (URL)</label>[span_101](end_span)
                <div class="d-flex align-items-center gap-3">
                    [span_102](start_span)<input type="url" class="form-control" name="avatarURL" placeholder="Avatar URL" required>[span_102](end_span)
                    [span_103](start_span)<img src="<%= botAvatar %>" id="avatar-preview" class="avatar-preview shadow" style="width: 50px; height: 50px; border-radius: 12px; object-fit: cover;">[span_103](end_span)
                    [span_104](start_span)<button class="btn btn-primary px-4" type="submit">Güncelle</button>[span_104](end_span)
                </div>
            </form>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script>
        function toggleSidebar() {
            [span_105](start_span)const sidebar = document.getElementById('sidebar');[span_105](end_span)
            [span_106](start_span)sidebar.classList.toggle('open');[span_106](end_span)
        }
        
        document.addEventListener('click', function(event) {
            [span_107](start_span)const sidebar = document.getElementById('sidebar');[span_107](end_span)
            const sidebarToggle = document.querySelector('.sidebar-toggle');
            if (window.innerWidth <= 992) {
                if (!sidebar.contains(event.target) && !sidebarToggle.contains(event.target)) {
                    [span_108](start_span)sidebar.classList.remove('open');[span_108](end_span)
                }
            }
        });

        [span_109](start_span)window.uptime = Number('<%= uptime %>');[span_109](end_span)
        function msToTime(duration) {
            let seconds = Math.floor((duration / 1000) % 60),
                minutes = Math.floor((duration / (1000 * 60)) % 60),
                hours = Math.floor((duration / (1000 * 60 * 60)) % 24),
                [span_110](start_span)days = Math.floor(duration / (1000 * 60 * 60 * 24));[span_110](end_span)
            [span_111](start_span)return `${days > 0 ? days + 'g ' : ''}${hours}sa ${minutes}dk ${seconds}sn`;[span_111](end_span)
        }
        [span_112](start_span)document.getElementById('uptime-value').innerText = msToTime(window.uptime);[span_112](end_span)

        function botControl(action) {
            [span_113](start_span)let endpoint = '';[span_113](end_span)
            [span_114](start_span)if (action === 'restart') endpoint = '/bot-settings/<%= guildID %>/restart';[span_114](end_span)
            else if (action === 'stop') { alert('Durdurma için process yöneticisi gereklidir!'); return; [span_115](start_span)}
            else if (action === 'start') { alert('Bot zaten çalışıyor!'); return; }[span_115](end_span)
            
            fetch(endpoint, { method: 'POST' })
                .then(r => r.json()).then(d => {
                    [span_116](start_span)document.getElementById('bot-action-result').innerText = d.message || '';[span_116](end_span)
                });
        }

        document.getElementById('username-form').onsubmit = function(e) {
            [span_117](start_span)e.preventDefault();[span_117](end_span)
            [span_118](start_span)const username = this.username.value;[span_118](end_span)
            fetch('/bot-settings/<%= guildID %>/set-username', {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify({ username })
            }).then(r => r.json()).then(d => {
                [span_119](start_span)document.getElementById('bot-action-result').innerText = d.message || '';[span_119](end_span)
                [span_120](start_span)if (d.success) setTimeout(() => location.reload(), 1000);[span_120](end_span)
            });
        };

        document.getElementById('avatar-form').onsubmit = function(e) {
            [span_121](start_span)e.preventDefault();[span_121](end_span)
            [span_122](start_span)const avatarURL = this.avatarURL.value;[span_122](end_span)
            fetch('/bot-settings/<%= guildID %>/set-avatar', {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify({ avatarURL })
            }).then(r => r.json()).then(d => {
                [span_123](start_span)document.getElementById('bot-action-result').innerText = d.message || '';[span_123](end_span)
                [span_124](start_span)if (d.success) setTimeout(() => location.reload(), 1000);[span_124](end_span)
            });
        };

        document.querySelector('input[name="avatarURL"]').addEventListener('input', function() {
            [span_125](start_span)document.getElementById('avatar-preview').src = this.value || '<%= botAvatar %>';[span_125](end_span)
        });
    </script>
</body>
<%- include('layout-blocker.ejs') %>
</html>
 
